package modbus

import (
	"bufio"
	"encoding/binary"
	"fmt"
	"github.com/jgulick48/lxp-bridge-go/internal/models"
	"github.com/jgulick48/lxp-bridge-go/internal/registers"
	"github.com/sirupsen/logrus"
	"log"
	"net"
)

type Client interface {
	Connect(done chan bool) error
}

type client struct {
	config   models.LXPConfig
	logger   *log.Logger
	messages chan byte
	commands chan []byte
}

func NewClient(config models.LXPConfig, logger *logrus.Logger) Client {
	c := client{
		config:   config,
		messages: make(chan byte),
		commands: make(chan []byte),
	}
	go c.processMessages()
	return &c
}

func (c *client) Connect(done chan bool) error {
	conn, err := net.Dial("tcp", fmt.Sprintf("%s:%v", c.config.Host, c.config.Port))
	if err != nil {
		return err
	}
	//message := []byte{161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 21, 0, 6, 0, 25, 2, 41, 100, 0, 53, 0, 0, 0, 0, 0, 0, 137, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 45, 46, 54, 19, 0, 0, 106, 9, 73, 0, 58, 51, 82, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 76, 0, 103, 0, 165, 0, 241, 0, 0, 0, 0, 0, 158, 15, 59, 13, 151, 94, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 41, 29, 0, 0, 253, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 80, 0, 56, 0, 242, 0, 0, 0, 114, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 41, 21, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 115, 9, 119, 23, 89, 53, 89, 0, 193, 44, 0, 0, 178, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 216, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 105, 133, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 21, 0, 6, 0, 25, 2, 41, 100, 0, 53, 0, 0, 0, 0, 0, 0, 135, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 42, 46, 79, 19, 0, 0, 115, 9, 73, 0, 58, 51, 118, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 76, 0, 103, 0, 165, 0, 241, 0, 0, 0, 0, 0, 159, 15, 60, 13, 240, 123, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 41, 29, 0, 0, 253, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 124, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 71, 201, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 113, 9, 118, 23, 35, 53, 89, 0, 193, 44, 0, 0, 183, 4, 184, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 198, 2, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 21, 0, 6, 0, 25, 2, 41, 100, 0, 53, 0, 0, 0, 0, 0, 0, 133, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 46, 46, 62, 19, 0, 0, 108, 9, 73, 0, 58, 51, 120, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 76, 0, 103, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 59, 13, 193, 52, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 41, 29, 0, 0, 253, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 134, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 146, 253, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 106, 9, 86, 23, 12, 53, 89, 0, 193, 44, 0, 0, 178, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65, 51, 161, 26, 5, 0, 13, 0, 1, 193, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 0, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 254, 32, 0, 0, 0, 20, 0, 6, 0, 25, 2, 41, 100, 0, 53, 0, 0, 0, 0, 0, 0, 133, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 53, 46, 62, 19, 0, 0, 108, 9, 73, 0, 58, 51, 127, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 76, 0, 104, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 59, 13, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 41, 29, 0, 0, 254, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 80, 0, 56, 0, 242, 0, 0, 0, 139, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 2, 0, 184, 11, 112, 23, 48, 2, 194, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 6, 0, 88, 2, 227, 7, 0, 0, 0, 0, 38, 13, 28, 13, 240, 0, 200, 0, 8, 0, 93, 0, 22, 2, 132, 1, 0, 0, 0, 0, 0, 0, 0, 0, 5, 1, 221, 6, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 209, 7, 105, 9, 127, 23, 7, 53, 90, 0, 194, 44, 0, 0, 156, 124, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 127, 0, 254, 178, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 190, 6, 254, 0, 71, 58, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 44, 1, 0, 0, 44, 0, 0, 0, 50, 0, 100, 0, 100, 0, 20, 0, 144, 1, 48, 2, 20, 0, 70, 0, 250, 0, 0, 0, 0, 0, 48, 2, 144, 1, 0, 0, 200, 0, 0, 0, 0, 0, 50, 0, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 28, 2, 224, 1, 90, 0, 60, 0, 5, 0, 50, 0, 8, 2, 50, 0, 90, 0, 244, 1, 28, 2, 13, 3, 0, 0, 8, 0, 101, 0, 83, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 0, 0, 0, 0, 0, 0, 0, 1, 0, 44, 1, 0, 0, 255, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 78, 146, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 254, 0, 254, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 62, 33, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 20, 0, 7, 0, 25, 2, 41, 100, 0, 53, 0, 0, 0, 0, 0, 0, 140, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 48, 46, 54, 19, 0, 0, 108, 9, 73, 0, 58, 51, 121, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 77, 0, 104, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 59, 13, 73, 238, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 42, 29, 0, 0, 254, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 144, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 38, 207, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 107, 9, 131, 23, 5, 53, 90, 0, 194, 44, 0, 0, 178, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 216, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 172, 72, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 20, 0, 6, 0, 25, 2, 41, 100, 0, 53, 0, 0, 0, 0, 0, 0, 148, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 39, 46, 54, 19, 0, 0, 108, 9, 73, 0, 58, 51, 125, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 77, 0, 104, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 59, 13, 252, 137, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 42, 29, 0, 0, 254, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 154, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 12, 176, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 110, 9, 118, 23, 70, 53, 90, 0, 194, 44, 0, 0, 183, 4, 184, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 130, 18, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 20, 0, 6, 0, 25, 2, 41, 100, 0, 53, 0, 0, 0, 0, 0, 0, 141, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 50, 46, 75, 19, 0, 0, 115, 9, 73, 0, 58, 51, 119, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 77, 0, 104, 0, 165, 0, 241, 0, 0, 0, 0, 0, 158, 15, 60, 13, 64, 198, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 42, 29, 0, 0, 254, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 164, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 80, 43, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 111, 9, 131, 23, 9, 53, 91, 0, 195, 44, 0, 0, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 216, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 235, 59, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 20, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 139, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 49, 46, 62, 19, 0, 0, 103, 9, 73, 0, 58, 51, 121, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 78, 0, 105, 0, 165, 0, 241, 0, 0, 0, 0, 0, 158, 15, 60, 13, 164, 115, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 43, 29, 0, 0, 255, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 174, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 186, 152, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 108, 9, 87, 23, 229, 52, 91, 0, 195, 44, 0, 0, 178, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 94, 107, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 19, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 147, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 54, 46, 66, 19, 0, 0, 110, 9, 73, 0, 58, 51, 125, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 78, 0, 105, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 60, 13, 47, 143, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 43, 29, 0, 0, 255, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 184, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 77, 191, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 109, 9, 126, 23, 13, 53, 91, 0, 195, 44, 0, 0, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 180, 254, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 19, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 136, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 49, 46, 54, 19, 0, 0, 108, 9, 73, 0, 58, 51, 123, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 78, 0, 105, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 60, 13, 202, 156, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 43, 29, 0, 0, 255, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 194, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 16, 227, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 108, 9, 122, 23, 76, 53, 92, 0, 196, 44, 0, 0, 178, 4, 180, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 162, 220, 161, 26, 5, 0, 13, 0, 1, 193, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 0, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 254, 32, 0, 0, 0, 19, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 133, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 56, 46, 49, 19, 0, 0, 106, 9, 73, 0, 58, 51, 82, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 78, 0, 105, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 59, 13, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 43, 29, 0, 0, 255, 188, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 199, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 2, 0, 184, 11, 112, 23, 48, 2, 194, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 6, 0, 88, 2, 230, 7, 0, 0, 0, 0, 38, 13, 28, 13, 240, 0, 200, 0, 8, 0, 93, 0, 22, 2, 133, 1, 0, 0, 0, 0, 0, 0, 0, 0, 5, 1, 89, 6, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 208, 7, 105, 9, 82, 23, 193, 52, 92, 0, 196, 44, 0, 0, 240, 39, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 127, 0, 254, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 216, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 114, 6, 255, 0, 72, 58, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 44, 1, 0, 0, 44, 0, 0, 0, 50, 0, 100, 0, 100, 0, 20, 0, 144, 1, 48, 2, 20, 0, 70, 0, 250, 0, 0, 0, 0, 0, 48, 2, 144, 1, 0, 0, 200, 0, 0, 0, 0, 0, 50, 0, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 28, 2, 224, 1, 90, 0, 60, 0, 5, 0, 50, 0, 8, 2, 50, 0, 90, 0, 244, 1, 28, 2, 13, 3, 0, 0, 8, 0, 101, 0, 83, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 0, 0, 0, 0, 0, 0, 0, 1, 0, 44, 1, 0, 0, 255, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 95, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 254, 0, 254, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 62, 33, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 19, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 139, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 38, 46, 49, 19, 0, 0, 106, 9, 73, 0, 58, 51, 86, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 78, 0, 106, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 60, 13, 146, 166, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 44, 29, 0, 0, 0, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 204, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 161, 40, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 111, 9, 120, 23, 58, 53, 92, 0, 196, 44, 0, 0, 178, 4, 180, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 53, 110, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 18, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 144, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 58, 46, 66, 19, 0, 0, 115, 9, 73, 0, 58, 51, 121, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 79, 0, 106, 0, 165, 0, 241, 0, 0, 0, 0, 0, 159, 15, 60, 13, 105, 0, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 44, 29, 0, 0, 0, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 214, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 154, 90, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 110, 9, 82, 23, 3, 53, 93, 0, 197, 44, 0, 0, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 221, 202, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 80, 0, 80, 2, 0, 184, 11, 112, 23, 48, 2, 194, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 6, 0, 88, 2, 227, 7, 0, 0, 0, 0, 38, 13, 29, 13, 240, 0, 200, 0, 8, 0, 93, 0, 22, 2, 132, 1, 0, 0, 0, 0, 0, 0, 0, 0, 5, 1, 250, 6, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 149, 24, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 18, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 146, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 58, 46, 66, 19, 0, 0, 112, 9, 73, 0, 58, 51, 84, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 79, 0, 106, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 60, 13, 145, 218, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 44, 29, 0, 0, 0, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 224, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 79, 103, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 108, 9, 127, 23, 21, 53, 93, 0, 197, 44, 0, 0, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 216, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 186, 190, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 18, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 145, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 62, 46, 66, 19, 0, 0, 110, 9, 73, 0, 58, 51, 129, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 79, 0, 106, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 60, 13, 178, 237, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 45, 29, 0, 0, 0, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 234, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 164, 232, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 110, 9, 132, 23, 67, 53, 93, 0, 197, 44, 0, 0, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 216, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 140, 121, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 17, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 141, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 50, 46, 75, 19, 0, 0, 112, 9, 73, 0, 58, 51, 129, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 80, 0, 107, 0, 165, 0, 241, 0, 0, 0, 0, 0, 158, 15, 60, 13, 165, 131, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 45, 29, 0, 0, 1, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 244, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 219, 85, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 106, 9, 126, 23, 11, 53, 94, 0, 198, 44, 0, 0, 178, 4, 180, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 52, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 17, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 156, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 54, 46, 62, 19, 0, 0, 106, 9, 73, 0, 58, 51, 82, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 80, 0, 107, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 60, 13, 179, 126, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 45, 29, 0, 0, 1, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 254, 168, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 241, 42, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 109, 9, 94, 23, 6, 53, 94, 0, 198, 44, 0, 0, 178, 4, 180, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 216, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 105, 3, 161, 26, 5, 0, 13, 0, 1, 193, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 0, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 254, 32, 0, 0, 0, 17, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 150, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 39, 46, 54, 19, 0, 0, 106, 9, 73, 0, 58, 51, 123, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 80, 0, 107, 0, 165, 0, 241, 0, 0, 0, 0, 0, 157, 15, 60, 13, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 45, 29, 0, 0, 1, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 3, 169, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 2, 0, 184, 11, 112, 23, 48, 2, 194, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 6, 0, 88, 2, 229, 7, 0, 0, 0, 0, 38, 13, 29, 13, 250, 0, 200, 0, 8, 0, 93, 0, 22, 2, 132, 1, 0, 0, 0, 0, 0, 0, 0, 0, 5, 1, 229, 6, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 208, 7, 105, 9, 123, 23, 19, 53, 94, 0, 198, 44, 0, 0, 67, 13, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 127, 0, 254, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 216, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 192, 6, 255, 0, 72, 58, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100, 0, 44, 1, 0, 0, 44, 0, 0, 0, 50, 0, 100, 0, 100, 0, 20, 0, 144, 1, 48, 2, 20, 0, 70, 0, 250, 0, 0, 0, 0, 0, 48, 2, 144, 1, 0, 0, 200, 0, 0, 0, 0, 0, 50, 0, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 28, 2, 224, 1, 90, 0, 60, 0, 5, 0, 50, 0, 8, 2, 50, 0, 90, 0, 244, 1, 28, 2, 13, 3, 0, 0, 8, 0, 101, 0, 83, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 0, 0, 0, 0, 0, 0, 0, 1, 0, 44, 1, 0, 0, 255, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 68, 138, 161, 26, 5, 0, 29, 1, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 15, 1, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 254, 0, 254, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 62, 33, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 17, 0, 6, 0, 25, 2, 42, 100, 0, 53, 0, 0, 0, 0, 0, 0, 151, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 35, 46, 54, 19, 0, 0, 108, 9, 73, 0, 58, 51, 82, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 80, 0, 107, 0, 165, 0, 241, 0, 0, 0, 0, 0, 156, 15, 60, 13, 134, 232, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 45, 29, 0, 0, 1, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 8, 169, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 248, 154, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 208, 7, 104, 9, 130, 23, 200, 52, 94, 0, 198, 44, 0, 0, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 228, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 153, 136, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 17, 0, 6, 0, 25, 2, 43, 100, 0, 53, 0, 0, 0, 0, 0, 0, 147, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 36, 46, 75, 19, 0, 0, 115, 9, 73, 0, 58, 51, 127, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 81, 0, 108, 0, 165, 0, 241, 0, 0, 0, 0, 0, 158, 15, 60, 13, 144, 39, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 46, 29, 0, 0, 2, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 18, 169, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 128, 253, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 111, 9, 133, 23, 89, 53, 95, 0, 199, 44, 0, 0, 183, 4, 184, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 133, 130, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 16, 0, 6, 0, 25, 2, 43, 100, 0, 53, 0, 0, 0, 0, 0, 0, 150, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 51, 46, 66, 19, 0, 0, 110, 9, 73, 0, 58, 51, 121, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 81, 0, 108, 0, 165, 0, 241, 0, 0, 0, 0, 0, 156, 15, 60, 13, 224, 110, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 40, 0, 80, 145, 51, 1, 0, 205, 22, 0, 0, 13, 0, 0, 0, 5, 0, 0, 0, 46, 29, 0, 0, 2, 189, 0, 0, 49, 171, 0, 0, 42, 44, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 0, 81, 0, 56, 0, 242, 0, 0, 0, 28, 169, 192, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 239, 113, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 120, 0, 80, 209, 7, 111, 9, 132, 23, 2, 53, 95, 0, 199, 44, 0, 0, 180, 4, 182, 4, 0, 0, 0, 0, 0, 0, 0, 0, 241, 0, 241, 0, 42, 44, 1, 0, 42, 44, 1, 0, 0, 0, 229, 7, 214, 7, 0, 75, 45, 35, 1, 6, 0, 39, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 247, 161, 26, 5, 0, 111, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 97, 0, 1, 4, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 80, 32, 0, 0, 0, 16, 0, 6, 0, 25, 2, 43, 100, 0, 53, 0, 0, 0, 0, 0, 0, 132, 43, 0, 0, 0, 0, 5, 1, 236, 0, 0, 0, 0, 0, 49, 46, 66, 19, 0, 0, 112, 9, 73, 0, 58, 51, 128, 23, 0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 23, 0, 0, 0, 0, 0, 81, 0, 108, 0, 165, 0, 241, 0, 0, 0, 0, 0, 158, 15, 60, 13, 187, 10}
	//
	//loops := 0
	var message byte
	var loops int
	reader := bufio.NewReader(conn)
	for {
		if loops == 0 {
			logrus.Info("Sending request for hold data")
			//command := BuildPacket("BA31101550", "3192670065", 0, 0x6, 196, 22)
			command := BuildPacket("BA31101550", "3192670065", 0, 0x6, 196, 20)
			//	command = []byte{161, 26, 1, 0, 32, 0, 1, 194, 66, 65, 51, 49, 49, 48, 49, 53, 53, 48, 18, 0, 0, 3, 51, 49, 57, 50, 54, 55, 48, 48, 54, 53, 0, 0, 40, 0, 19, 3}
			n, err := conn.Write(command)
			if err != nil {
				logrus.Errorf("Error sending command: %s", err.Error())
			}
			reply := make([]byte, 1024)
			_, err = conn.Read(reply)
			messageLengthRemaining := binary.LittleEndian.Uint16(reply[4:6])
			messageSendFunction := func(register registers.Register, value float64) {
				logrus.Infof("%s: %v %s", register.Name, value*register.Multiplier, register.Unit)
			}
			Decode(reply[:messageLengthRemaining+6], messageSendFunction)

			logrus.Infof("Wrote %v bytes to connection %v\n Got back %v", n, command, reply)
		}
		loops++
		message, err = reader.ReadByte()
		if err != nil {
			fmt.Println(fmt.Sprintf("Error reading connection: %s", err.Error()))
		}
		c.messages <- message
	}
}

func (c *client) processMessages() {
	byteCount := 0
	messageLengthRemaining := uint16(0)
	messageSendFunction := func(register registers.Register, value float64) {
		logrus.Infof("%s: %v %s", register.Name, value*register.Multiplier, register.Unit)
	}
	message := make([]byte, 0)
	for m := range c.messages {
		message = append(message, m)
		if byteCount == 0 {
			if m != 161 {
				byteCount = 0
				message = make([]byte, 0)
				messageLengthRemaining = uint16(0)
				continue
			}
		}
		if byteCount == 1 {
			if m != 26 {
				byteCount = 0
				message = make([]byte, 0)
				messageLengthRemaining = uint16(0)
				continue
			}
		}
		if byteCount == 5 {
			messageLengthRemaining = binary.LittleEndian.Uint16(message[4:6])
		}
		if byteCount > 5 && messageLengthRemaining > 0 {
			messageLengthRemaining--
		}
		if byteCount > 5 && messageLengthRemaining == 0 {
			_, _ = Decode(message, messageSendFunction)
			message = make([]byte, 0)
			byteCount = 0
			continue
		}

		byteCount++
	}
}
